# Documentation
- Class name: SaveAnimatedPNG
- Category: image/animation
- Output node: True
- Repo Ref: https://github.com/comfyanonymous/ComfyUI

The SaveAnimatedPNG node is designed to efficiently save a series of images into animated PNG files. It takes into account frame rates and compression levels to optimize animation performance and storage needs. The node plays a key role in the final output of the image generation workflow, ensuring that the animation is generated in high quality and efficient packaging.

# Input types
## Required
- images
    - The `images' parameter is essential because it defines the sequence of images to be compiled into animated PNG. It directly influences the final output and determines the content and quality of the animation.
    - Comfy dtype: IMAGE
    - Python dtype: torch.Tensor
- fps
    - The 'fps' parameter determines the speed of animated play, measured by the number of frames per second. It is a key factor in setting the animated rhythm and ensuring a fluid view of the experience.
    - Comfy dtype: FLOAT
    - Python dtype: float
- compress_level
    - The `compress_level' parameter adjusts the compression level of the PNG file, which helps to balance file size with image quality. This is important for optimizing storage and loading time.
    - Comfy dtype: INT
    - Python dtype: int
## Optional
- filename_prefix
    - The `filename_prefix' parameter allows users to assign custom prefixes to the output filenames, which is very useful for organizing and identifying animations saved.
    - Comfy dtype: STRING
    - Python dtype: str
- prompt
    - The `prompt' parameter is used to store additional context or description associated with the image being saved. It can provide valuable information for future reference or metadata purposes.
    - Comfy dtype: PROMPT
    - Python dtype: str
- extra_pnginfo
    - The `extra_pnginfo' parameter allows for the inclusion of additional metadata in the PNG file, which can be used to embed custom data or notes.
    - Comfy dtype: EXTRA_PNGINFO
    - Python dtype: Dict[str, str]

# Output types
- ui
    - The 'ui'parameter covers the user interface elements generated by the node operation. It includes details such as filenames and subfolders, which are essential for the user to locate and interact with animated images saved.
    - Comfy dtype: DICT
    - Python dtype: Dict[str, Any]

# Usage tips
- Infra type: CPU

# Source code
```
class SaveAnimatedPNG:

    def __init__(self):
        self.output_dir = folder_paths.get_output_directory()
        self.type = 'output'
        self.prefix_append = ''

    @classmethod
    def INPUT_TYPES(s):
        return {'required': {'images': ('IMAGE',), 'filename_prefix': ('STRING', {'default': 'ComfyUI'}), 'fps': ('FLOAT', {'default': 6.0, 'min': 0.01, 'max': 1000.0, 'step': 0.01}), 'compress_level': ('INT', {'default': 4, 'min': 0, 'max': 9})}, 'hidden': {'prompt': 'PROMPT', 'extra_pnginfo': 'EXTRA_PNGINFO'}}
    RETURN_TYPES = ()
    FUNCTION = 'save_images'
    OUTPUT_NODE = True
    CATEGORY = 'image/animation'

    def save_images(self, images, fps, compress_level, filename_prefix='ComfyUI', prompt=None, extra_pnginfo=None):
        filename_prefix += self.prefix_append
        (full_output_folder, filename, counter, subfolder, filename_prefix) = folder_paths.get_save_image_path(filename_prefix, self.output_dir, images[0].shape[1], images[0].shape[0])
        results = list()
        pil_images = []
        for image in images:
            i = 255.0 * image.cpu().numpy()
            img = Image.fromarray(np.clip(i, 0, 255).astype(np.uint8))
            pil_images.append(img)
        metadata = None
        if not args.disable_metadata:
            metadata = PngInfo()
            if prompt is not None:
                metadata.add(b'comf', 'prompt'.encode('latin-1', 'strict') + b'\x00' + json.dumps(prompt).encode('latin-1', 'strict'), after_idat=True)
            if extra_pnginfo is not None:
                for x in extra_pnginfo:
                    metadata.add(b'comf', x.encode('latin-1', 'strict') + b'\x00' + json.dumps(extra_pnginfo[x]).encode('latin-1', 'strict'), after_idat=True)
        file = f'{filename}_{counter:05}_.png'
        pil_images[0].save(os.path.join(full_output_folder, file), pnginfo=metadata, compress_level=compress_level, save_all=True, duration=int(1000.0 / fps), append_images=pil_images[1:])
        results.append({'filename': file, 'subfolder': subfolder, 'type': self.type})
        return {'ui': {'images': results, 'animated': (True,)}}
```