# Documentation
- Class name: StyleAlignedSampleReferenceLatents
- Category: style_aligned
- Output node: False
- Repo Ref: https://github.com/brianfitzgerald/style_aligned_comfy

The `sample' method of StyleAligned SambleReferenceLatents node is designed to generate a reference potential sequence that is consistent with the style of the given potential image. It uses a model to sample a noise output that is consistent with the input conditions. This node is essential for a series of applications that require the production of images to keep their style consistent.

# Input types
## Required
- model
    - Model parameters are essential for the operation of nodes because they provide the underlying neural network structure for sampling. They directly affect the generation of potential quality and style.
    - Comfy dtype: MODEL
    - Python dtype: torch.nn.Module
- positive
    - The positionive parameter defines the positive condition factor that guides the sampling towards a particular style. It plays an important role in shaping the style features of the output.
    - Comfy dtype: CONDITIONING
    - Python dtype: Union[str, torch.Tensor]
- negative
    - The nigative parameters specify the conditions to be avoided during the sampling process to ensure that the potential generated does not exhibit undesirable style features.
    - Comfy dtype: CONDITIONING
    - Python dtype: Union[str, torch.Tensor]
- sampler
    - The sampler parameter determines the sampling strategy to be used at the node. It is essential to control the generation of potential randomity and diversity.
    - Comfy dtype: SAMPLER
    - Python dtype: Callable
- sigmas
    - The sigmas parameter represents the variance used in the sampling process to control the spread of noise. It is a key factor in fine-tuning the details of potential styles.
    - Comfy dtype: SIGMAS
    - Python dtype: torch.Tensor
- latent_image
    - The latent_image parameter is a key input that provides the initial potential state at which the sampling process begins. It sets the basic style for the reference potential to be generated.
    - Comfy dtype: LATENT
    - Python dtype: Dict[str, torch.Tensor]
## Optional
- noise_seed
    - The noise_seed parameter is used for random noises applied during the initial sampling process. When a particular noise mode is required, it ensures that the results are repeated.
    - Comfy dtype: INT
    - Python dtype: int
- cfg
    - The cfg parameter controls the configuration of the sampling process, influencing the generation of potential scale and detail. It is a key factor in achieving the desired style results.
    - Comfy dtype: FLOAT
    - Python dtype: float

# Output types
- ref_latents
    - Ref_lates output is a series of reference potentials generated by nodes. These potentials are consistent with the style of input potential images and are used for further processing or analysis.
    - Comfy dtype: STEP_LATENTS
    - Python dtype: torch.Tensor
- noised_output
    - Noised_output parameters represent the final output of the sampling process, which is a noise version of the input of a potential image. It covers the essence of the type of input and introduces variability.
    - Comfy dtype: LATENT
    - Python dtype: Dict[str, torch.Tensor]

# Usage tips
- Infra type: GPU

# Source code
```
class StyleAlignedSampleReferenceLatents:

    @classmethod
    def INPUT_TYPES(s):
        return {'required': {'model': ('MODEL',), 'noise_seed': ('INT', {'default': 0, 'min': 0, 'max': 18446744073709551615}), 'cfg': ('FLOAT', {'default': 8.0, 'min': 0.0, 'max': 100.0, 'step': 0.1, 'round': 0.01}), 'positive': ('CONDITIONING',), 'negative': ('CONDITIONING',), 'sampler': ('SAMPLER',), 'sigmas': ('SIGMAS',), 'latent_image': ('LATENT',)}}
    RETURN_TYPES = ('STEP_LATENTS', 'LATENT')
    RETURN_NAMES = ('ref_latents', 'noised_output')
    FUNCTION = 'sample'
    CATEGORY = 'style_aligned'

    def sample(self, model, noise_seed, cfg, positive, negative, sampler, sigmas, latent_image):
        sigmas = sigmas.flip(0)
        if sigmas[0] == 0:
            sigmas[0] = 0.0001
        latent = latent_image
        latent_image = latent['samples']
        noise = torch.zeros(latent_image.size(), dtype=latent_image.dtype, layout=latent_image.layout, device='cpu')
        noise_mask = None
        if 'noise_mask' in latent:
            noise_mask = latent['noise_mask']
        ref_latents = []

        def callback(step: int, x0: T, x: T, steps: int):
            ref_latents.insert(0, x[0])
        disable_pbar = not comfy.utils.PROGRESS_BAR_ENABLED
        samples = comfy.sample.sample_custom(model, noise, cfg, sampler, sigmas, positive, negative, latent_image, noise_mask=noise_mask, callback=callback, disable_pbar=disable_pbar, seed=noise_seed)
        out = latent.copy()
        out['samples'] = samples
        out_noised = out
        ref_latents = torch.stack(ref_latents)
        return (ref_latents, out_noised)
```